<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Today's Bookings - Practitioner View</title>
<style>
  :root{
    --bg:#f6fbfb; --card:#fff; --ink:#1e2a2a; --muted:#5e6b6b; --accent:#008e8c; --accent-2:#6bd6c8;
    --warn:#c2410c; --ok:#0f766e; --ring:0 0 0 3px rgba(0,142,140,.18); --shadow:0 14px 36px rgba(0,0,0,.08);
    --radius:16px; --chip:#eef7f6; --chip-b:#d9eeeb;
  }
  html,body{height:100%;}
  body{margin:0;background:#f8faf9;color:var(--ink);font-family:Inter,ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial}
  header{
    background:var(--accent); color:#fff; padding:18px 20px; display:flex; justify-content:space-between; align-items:center;
    box-shadow:0 6px 18px rgba(0,0,0,.06);
  }
  .header-title{font-weight:700;font-size:clamp(18px,3vw,22px)}
  .header-date{font-size:14px;opacity:.9}
  .wrap{max-width:1200px;margin:24px auto 80px;padding:0 16px}
  .stats{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:14px;margin-bottom:24px}
  .stat-card{background:var(--card);border-radius:var(--radius);box-shadow:var(--shadow);padding:20px;text-align:center}
  .stat-value{font-size:32px;font-weight:700;color:var(--accent);margin:8px 0}
  .stat-label{font-size:13px;color:var(--muted);text-transform:uppercase;letter-spacing:.5px}
  .filters{display:flex;gap:10px;margin-bottom:16px;flex-wrap:wrap}
  .filter-btn{padding:8px 16px;border:2px solid #d8e9e6;border-radius:999px;background:#fff;cursor:pointer;font-weight:600;font-size:13px;transition:.15s}
  .filter-btn:hover{border-color:var(--accent);background:#f0f9f8}
  .filter-btn.active{border-color:var(--accent);background:#e7f7f4;color:var(--accent)}
  .bookings-list{display:flex;flex-direction:column;gap:12px}
  .booking-card{background:var(--card);border-radius:var(--radius);box-shadow:var(--shadow);padding:20px;display:grid;grid-template-columns:80px 1fr auto;gap:20px;align-items:center;transition:.15s}
  .booking-card:hover{box-shadow:0 8px 24px rgba(0,0,0,.12)}
  .time-badge{background:var(--accent);color:#fff;border-radius:12px;padding:12px;text-align:center;font-weight:700}
  .time-badge .time{font-size:18px}
  .time-badge .duration{font-size:11px;opacity:.85;margin-top:4px}
  .booking-info{flex:1}
  .booking-name{font-size:18px;font-weight:700;color:var(--ink);margin-bottom:6px}
  .booking-contact{font-size:13px;color:var(--muted);display:flex;gap:16px;flex-wrap:wrap}
  .booking-contact span{display:inline-flex;align-items:center;gap:4px}
  .status-badge{display:inline-block;padding:4px 12px;border-radius:999px;font-size:12px;font-weight:600;margin-top:8px}
  .status-badge.pending{background:#fff3cd;color:#856404;border:1px solid #ffc107}
  .status-badge.paid{background:#d4edda;color:#155724;border:1px solid #28a745}
  .status-badge.confirmed{background:#cce5ff;color:#004085;border:1px solid:#007bff}
  .status-badge.in-progress{background:#fff3cd;color:#856404;border:1px solid #ffc107}
  .status-badge.completed{background:#d4edda;color:#155724;border:1px solid #28a745}
  .booking-actions{display:flex;flex-direction:column;gap:8px;min-width:160px}
  .btn{padding:10px 16px;border-radius:8px;border:0;font-weight:600;cursor:pointer;font-size:14px;transition:.15s;white-space:nowrap}
  .btn-primary{background:var(--accent);color:#fff;box-shadow:0 4px 12px rgba(0,142,140,.25)}
  .btn-primary:hover{background:#006d6b}
  .btn-primary:disabled{opacity:.5;cursor:not-allowed}
  .btn-secondary{background:#e9f6f4;color:#0a6e6a;border:1px solid #d4efea}
  .btn-secondary:hover{background:#d4efea}
  .btn-success{background:#28a745;color:#fff;box-shadow:0 4px 12px rgba(40,167,69,.25)}
  .btn-success:hover{background:#218838}
  .empty-state{text-align:center;padding:60px 20px;color:var(--muted)}
  .empty-state-icon{font-size:48px;margin-bottom:16px}
  @media(max-width:768px){
    .booking-card{grid-template-columns:1fr;gap:16px}
    .booking-actions{flex-direction:row}
  }
</style>
</head>
<body>
  <header>
    <div>
      <div class="header-title">üìã Today's Bookings</div>
      <div class="header-date" id="currentDate"></div>
    </div>
    <div>
      <button class="btn btn-secondary" onclick="refreshBookings()">üîÑ Refresh</button>
    </div>
  </header>

  <div class="wrap">

    <!-- Stats -->
    <div class="stats">
      <div class="stat-card">
        <div class="stat-label">Total Bookings</div>
        <div class="stat-value" id="totalBookings">0</div>
      </div>
      <div class="stat-card">
        <div class="stat-label">Confirmed</div>
        <div class="stat-value" id="confirmedBookings">0</div>
      </div>
      <div class="stat-card">
        <div class="stat-label">In Progress</div>
        <div class="stat-value" id="inProgressBookings">0</div>
      </div>
      <div class="stat-card">
        <div class="stat-label">Completed</div>
        <div class="stat-value" id="completedBookings">0</div>
      </div>
    </div>

    <!-- Filters -->
    <div class="filters">
      <button class="filter-btn active" data-filter="all" onclick="filterBookings('all')">All</button>
      <button class="filter-btn" data-filter="pending" onclick="filterBookings('pending')">Pending Payment</button>
      <button class="filter-btn" data-filter="confirmed" onclick="filterBookings('confirmed')">Confirmed</button>
      <button class="filter-btn" data-filter="in-progress" onclick="filterBookings('in-progress')">In Progress</button>
      <button class="filter-btn" data-filter="completed" onclick="filterBookings('completed')">Completed</button>
    </div>

    <!-- Bookings list -->
    <div class="bookings-list" id="bookingsList">
      <!-- Bookings will be dynamically populated -->
    </div>

    <!-- Empty state -->
    <div class="empty-state" id="emptyState" style="display:none">
      <div class="empty-state-icon">üìÖ</div>
      <p>No bookings found for this filter.</p>
    </div>

  </div>

<script>
// Sample bookings data - would come from API in production
const sampleBookings = [
  {
    id: 'bk_001',
    time: '10:00',
    duration: 30,
    firstName: 'Sarah',
    surname: 'Johnson',
    phone: '0412 345 678',
    email: 'sarah.j@email.com',
    paymentStatus: 'paid',
    bookingStatus: 'confirmed',
    notes: 'First time client'
  },
  {
    id: 'bk_002',
    time: '10:45',
    duration: 20,
    firstName: 'Michael',
    surname: 'Chen',
    phone: '0433 987 654',
    email: 'm.chen@email.com',
    paymentStatus: 'paid',
    bookingStatus: 'confirmed',
    notes: ''
  },
  {
    id: 'bk_003',
    time: '11:15',
    duration: 30,
    firstName: 'Emma',
    surname: 'Williams',
    phone: '0422 111 222',
    email: 'emma.w@email.com',
    paymentStatus: 'paid',
    bookingStatus: 'in-progress',
    notes: 'Prefers gentle intensity'
  },
  {
    id: 'bk_004',
    time: '12:00',
    duration: 15,
    firstName: 'David',
    surname: 'Brown',
    phone: '0444 555 666',
    email: 'david.b@email.com',
    paymentStatus: 'paid',
    bookingStatus: 'confirmed',
    notes: ''
  },
  {
    id: 'bk_005',
    time: '12:30',
    duration: 30,
    firstName: 'Lisa',
    surname: 'Garcia',
    phone: '0455 777 888',
    email: 'lisa.g@email.com',
    paymentStatus: 'pending',
    bookingStatus: 'pending',
    notes: 'Needs to complete payment'
  },
  {
    id: 'bk_006',
    time: '13:15',
    duration: 20,
    firstName: 'James',
    surname: 'Wilson',
    phone: '0466 999 000',
    email: 'james.w@email.com',
    paymentStatus: 'paid',
    bookingStatus: 'completed',
    notes: 'Session completed successfully'
  }
];

let bookings = [...sampleBookings];
let currentFilter = 'all';

// Set current date
document.getElementById('currentDate').textContent = new Date().toLocaleDateString('en-AU', {
  weekday: 'long',
  day: 'numeric',
  month: 'long',
  year: 'numeric'
});

function updateStats() {
  const total = bookings.length;
  const confirmed = bookings.filter(b => b.bookingStatus === 'confirmed').length;
  const inProgress = bookings.filter(b => b.bookingStatus === 'in-progress').length;
  const completed = bookings.filter(b => b.bookingStatus === 'completed').length;

  document.getElementById('totalBookings').textContent = total;
  document.getElementById('confirmedBookings').textContent = confirmed;
  document.getElementById('inProgressBookings').textContent = inProgress;
  document.getElementById('completedBookings').textContent = completed;
}

function renderBookings(filter = 'all') {
  const container = document.getElementById('bookingsList');
  const emptyState = document.getElementById('emptyState');

  let filteredBookings = bookings;
  if (filter !== 'all') {
    filteredBookings = bookings.filter(b => b.bookingStatus === filter);
  }

  if (filteredBookings.length === 0) {
    container.innerHTML = '';
    emptyState.style.display = 'block';
    return;
  }

  emptyState.style.display = 'none';

  container.innerHTML = filteredBookings.map(booking => `
    <div class="booking-card" data-id="${booking.id}">
      <div class="time-badge">
        <div class="time">${booking.time}</div>
        <div class="duration">${booking.duration} min</div>
      </div>

      <div class="booking-info">
        <div class="booking-name">${booking.firstName} ${booking.surname}</div>
        <div class="booking-contact">
          <span>üì± ${booking.phone}</span>
          <span>‚úâÔ∏è ${booking.email}</span>
        </div>
        ${booking.notes ? `<div style="margin-top:8px;font-size:13px;color:var(--muted)">üìù ${booking.notes}</div>` : ''}
        <div>
          <span class="status-badge ${booking.paymentStatus}">${booking.paymentStatus === 'paid' ? '‚úì Paid' : '‚è≥ Payment Pending'}</span>
          <span class="status-badge ${booking.bookingStatus}">${formatStatus(booking.bookingStatus)}</span>
        </div>
      </div>

      <div class="booking-actions">
        ${getActionButtons(booking)}
      </div>
    </div>
  `).join('');
}

function formatStatus(status) {
  const statusMap = {
    'pending': '‚è≥ Pending',
    'confirmed': '‚úì Confirmed',
    'in-progress': '‚ñ∂Ô∏è In Progress',
    'completed': '‚úÖ Completed'
  };
  return statusMap[status] || status;
}

function getActionButtons(booking) {
  if (booking.bookingStatus === 'pending') {
    return `
      <button class="btn btn-secondary" onclick="confirmBooking('${booking.id}')">
        Confirm Booking
      </button>
    `;
  }

  if (booking.bookingStatus === 'confirmed') {
    return `
      <button class="btn btn-primary" onclick="startSession('${booking.id}')">
        ‚ñ∂Ô∏è Start Session
      </button>
      <button class="btn btn-secondary" onclick="viewDetails('${booking.id}')">
        View Details
      </button>
    `;
  }

  if (booking.bookingStatus === 'in-progress') {
    return `
      <button class="btn btn-success" onclick="completeSession('${booking.id}')">
        ‚úì Complete Session
      </button>
    `;
  }

  if (booking.bookingStatus === 'completed') {
    return `
      <button class="btn btn-secondary" onclick="viewDetails('${booking.id}')">
        View Session
      </button>
    `;
  }

  return '';
}

function filterBookings(filter) {
  currentFilter = filter;

  // Update filter buttons
  document.querySelectorAll('.filter-btn').forEach(btn => {
    btn.classList.toggle('active', btn.dataset.filter === filter);
  });

  renderBookings(filter);
}

function confirmBooking(id) {
  const booking = bookings.find(b => b.id === id);
  if (booking) {
    booking.bookingStatus = 'confirmed';
    updateStats();
    renderBookings(currentFilter);
    alert(`Booking confirmed for ${booking.firstName} ${booking.surname}`);
  }
}

function startSession(id) {
  const booking = bookings.find(b => b.id === id);
  if (booking) {
    booking.bookingStatus = 'in-progress';
    updateStats();
    renderBookings(currentFilter);

    // In production: Navigate to intake form with booking data
    console.log('Starting session with booking data:', booking);
    alert(`Starting session for ${booking.firstName} ${booking.surname}\n\nRedirecting to intake form...`);

    // Would redirect to intake form:
    // window.location.href = `/intake?bookingId=${id}`;
  }
}

function completeSession(id) {
  const booking = bookings.find(b => b.id === id);
  if (booking && confirm(`Complete session for ${booking.firstName} ${booking.surname}?`)) {
    booking.bookingStatus = 'completed';
    updateStats();
    renderBookings(currentFilter);
    alert(`Session completed for ${booking.firstName} ${booking.surname}`);
  }
}

function viewDetails(id) {
  const booking = bookings.find(b => b.id === id);
  if (booking) {
    alert(`Booking Details:\n\nName: ${booking.firstName} ${booking.surname}\nTime: ${booking.time}\nDuration: ${booking.duration} minutes\nPhone: ${booking.phone}\nEmail: ${booking.email}\nPayment: ${booking.paymentStatus}\nStatus: ${booking.bookingStatus}${booking.notes ? '\n\nNotes: ' + booking.notes : ''}`);

    // In production: Open details modal or navigate to details page
  }
}

function refreshBookings() {
  // In production: Fetch latest bookings from API
  console.log('Refreshing bookings...');
  updateStats();
  renderBookings(currentFilter);
  alert('Bookings refreshed!');
}

// Initialize
updateStats();
renderBookings();
</script>
</body>
</html>
